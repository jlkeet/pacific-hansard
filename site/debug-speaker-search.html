<!DOCTYPE html>
<html>
<head>
    <title>Debug Speaker Search</title>
    <script src="js/jquery-3.4.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-autocomplete/1.0.7/jquery.auto-complete.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-autocomplete/1.0.7/jquery.auto-complete.min.css">
    <style>
        body { padding: 20px; font-family: Arial; }
        .test-section { margin: 20px 0; padding: 20px; border: 1px solid #ccc; }
        #speaker-input { width: 300px; padding: 10px; font-size: 16px; }
        pre { background: #f5f5f5; padding: 10px; overflow: auto; }
    </style>
</head>
<body>
    <h1>Speaker Search Debug</h1>
    
    <div class="test-section">
        <h2>1. Test Speaker API</h2>
        <button onclick="testAPI()">Test /api/speakers.php</button>
        <pre id="api-result"></pre>
    </div>
    
    <div class="test-section">
        <h2>2. Test Autocomplete</h2>
        <input type="text" id="speaker-input" placeholder="Type 'HON' to test...">
        <div id="autocomplete-result"></div>
    </div>
    
    <div class="test-section">
        <h2>3. Test Solr Query</h2>
        <button onclick="testSolr()">Test Solr Search</button>
        <pre id="solr-result"></pre>
    </div>
    
    <script>
    // Test API
    function testAPI() {
        $('#api-result').text('Loading...');
        $.ajax({
            url: '/api/speakers.php',
            data: { q: 'HON' },
            dataType: 'json',
            success: function(data) {
                $('#api-result').text(JSON.stringify(data, null, 2));
            },
            error: function(xhr, status, error) {
                $('#api-result').text('Error: ' + status + '\n' + error + '\n\nResponse:\n' + xhr.responseText);
            }
        });
    }
    
    // Test Autocomplete
    $(document).ready(function() {
        $('#speaker-input').autoComplete({
            source: function(term, response) {
                $('#autocomplete-result').html('<p>Searching for: ' + term + '</p>');
                $.getJSON('/api/speakers.php', { q: term }, function(data) {
                    $('#autocomplete-result').append('<p>Found ' + data.speakers.length + ' speakers</p>');
                    response(data.speakers);
                }).fail(function(xhr) {
                    $('#autocomplete-result').append('<p style="color:red">Error: ' + xhr.statusText + '</p>');
                });
            },
            minChars: 2,
            onSelect: function(e, term, item) {
                $('#autocomplete-result').append('<p style="color:green">Selected: ' + term + '</p>');
            }
        });
    });
    
    // Test Solr
    function testSolr() {
        $('#solr-result').text('Loading...');
        $.ajax({
            url: '/solr/hansard_core/select',
            data: {
                q: '*:*',
                rows: 1,
                fl: 'speaker,speaker2,title',
                wt: 'json'
            },
            dataType: 'json',
            success: function(data) {
                $('#solr-result').text(JSON.stringify(data, null, 2));
            },
            error: function(xhr, status, error) {
                $('#solr-result').text('Error: ' + status + '\n' + error + '\n\nResponse:\n' + xhr.responseText);
            }
        });
    }
    </script>
</body>
</html>